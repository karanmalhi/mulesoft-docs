= Mule ESB 3.1.3 Release Notes
:keywords: release notes, esb

The Mule team has worked hard to bring you Mule ESB 3.1.3. This follow-up release to link:/release-notes/mule-esb-3.1.2-release-notes[Mule ESB 3.1.2] continues MuleSoft's commitment to making Mule the industry's most powerful, simplest to use, and most up-to-date Open Source ESB. **Over 60 issues were fixed between this release and the previous one, making this release a highly recommended download---and the most stable version of our 3.1.x branch to date**.

== Current Release Version

[width="100%",cols="34%,33%,33%",options="header",]
|===
|  |Enterprise Edition |Community Edition
|ESB |x | 
|Management +
 Console |x | 
|===

== New in Mule ESB Version 3.1.3

=== Fixed a Memory Leak Involving Transformers and Dynamic Endpoints

We have eliminated a memory leak which occurred when Transformers and Dynamic Endpoints were used. Objects are now disposed off properly.

=== Message Properties Propagation Improvements

In this release we solved multiple problems regarding the handling of message properties through different Transports and Routers. We have added many tests to ensure that the problems do not reappear. We also invested much time to make sure that Mule ESB handles message properties consistently within Flows. If you encountered problems in this area with previous releases, please try out version 3.1.3.

For more about message properties, see: http://www.mulesoft.org/documentation/display/MULE3USER/Message+Property+Scopes[Message Property Scopes]

=== Error Handling Consistency

We also devoted much effort to improving error handling consistency throughout Mule ESB. We uncovered and fixed many error handling inconsistencies across multiple components, particularly those related to Flows. If you rely on exception strategies to get the most out of ESB, version 3.1.3 should be your choice.

For additional details on error handling, see: http://www.mulesoft.org/documentation/display/MULE3USER/Error+Handling[Error Handling]

=== Multiple Fixes on JMS and WMQ Transport

We have resolved multiple issues involving the JMS and WMQ Transports. Transactionality and error handling now work as expected. The replyTo and request-response features now work consistently. We also fixed the feature that includes a Message Processor in the response chain. These fixes should prove critical if you use either the JMS or WMQ Transport.

For reference information on the JMS Transport, see link:/mule-user-guide/v/3.7/jms-transport-reference[JMS Transport Reference].

For details about the WMQ Transport, see link:/mule-user-guide/v/3.7/mule-wmq-transport-reference[WMQ Transport Reference].

For overview disscusion of Mule Transports, see link:/mule-user-guide/v/3.7/connecting-using-transports[Connecting Using Transports].

== Known Issues in This Release


The following JIRAs remain open against this release of Mule ESB:

[width="100%",cols="25%,25%,25%,25%",options="header",]
|===
|Key |Component/s |Summary |Workaround
|EE-2478 |Examples / Tutorials |The Widget example seems like it has to be removed from 3.1.x release *Developers: Please let me know when the widget has been removed and bug closed so I can move this to the FIXED table---Norman* | 
|MULE-5633 |Modules: (other) |The WebAppClassLoader causes StackOverflowError within the ApplicationAwareRepositorySelector |Fixed in 3.2.0
|EE-2512 |Transport: JMS |A connection leak with transactional JMS |Fixed in 3.1.4 and 3.2.1 release
|EE-2505 |Core: Exception Handling |Transaction contexts are not propagated to exception strategies when the exception is thrown by the outbound-endpoint |Fixed in 3.1.4 and 3.2.1 release
|EE-2518 |Transport: CXF |CXF returns invalid response to ReplyTo destination when is called using MEP request-response. | 
|===

== Fixed in This Release


Mule version 3.1.3 builds on the features added in link:/release-notes/mule-esb-3.1.2-release-notes[version 3.1.2] and fixes the following issues:

[width="100%",cols="34%,33%,33%",options="header",]
|===
|Key |Component/s |Summary
|MULE-5762 |Schema |The configuration-ref is displayed twice in the mule-cxf schema, and in certain use cases, this causes Mule to fail
|MULE-5750 |Tools: Archetypes |Test generated by the mvn archetype fails with an assertion error
|MULE-5747 |Core: Lifecycle |Sub-flows (and the processors defined in them) don't get muleContext injected or lifecycle when used via flow-ref
|MULE-5737 |Core: Exception Handling |The Flows feature does not handle exceptions when invoked via i) a request-response vm inbound endpoint ii) a flow-ref
|MULE-5730 |Build: Integration Tests |testFlowRef() in FlowConfigurationFunctionalTestCase passes, but the expected payload should be "012xyzabc312xyzabc3" not "012xyzabc3"
|MULE-5718 |Schema |HTTP throwing "Property "cookieSpec" exposes an incorrect or unsupported value "rfc2109"" error while the schema admits this value
|MULE-5708 |Documentation / Website, Examples / Tutorials |In the example-launcher example, the link in the README.txt points to a page which says "You cannot view this page due to inherited restrictions"
|MULE-5681 |Tools: Archetypes |Transport Archetype: Tests fail from Maven
|MULE-5670 |Core: (other) |Schema issue - Incorrect Inheritance for Transformer Reference
|MULE-5669 |Core: Configuration, Tools: Archetypes |There is no option to include the documentation module when creating an archetype in Mvn
|MULE-5668 |Transport: File |Schema inconsistencies - File connector contains transaction options because of schema inheritance
|MULE-5663 |Documentation / Website |CustomXMLNamespace documentation suggests use of invalid code
|MULE-5651 |Modules: XML, XSLT, XPath, SXC |No information is displayed for some transformers due to the type attribute missing from the schema - XSLT is not detecting inheritance
|MULE-5604 |Transport: FTP / SFTP |The FTP connector should not change the working directory if Path is empty
|MULE-5601 |Core: (other) |We must implement Service Result Caching
|MULE-5597 |Transport: TCP / UDP / SSL / Multicast |response transformers are applied twice on udp:inbound-endpoint
|MULE-5591 |Core: Transports |getSize(filename) is SftpClient.java prepends "./" to the path
|MULE-5590 |Transport: TCP / UDP / SSL / Multicast |The UDP transport does not allow request-response endpoints
|MULE-5583 |Transport: HTTP(S) / Jetty |Allow a cert to be selected out of a keystore with multiple certs and different passwords for the HTTPS connector
|MULE-5582 |Modules: Management / JMX |JMX credentials are ignored on the server
|MULE-5578 |Core: Exception Handling, Core: Routing / Filters |<message-filter throwOnUnaccepted="true"> does not work for endpoints with exchange pattern request-response
|MULE-5577 |Core: Bootstrap / Standalone |Allow users to pass wrapper parameters using the command line
|MULE-5575 |Core: Bootstrap / Standalone |Polling receivers use wrong classloader when running in the Mule standalone
|MULE-5568 |Modules: XML, XSLT, XPath, SXC |xml-prettyprinter-transformer won't honor newlines=false when suppressDeclaration=false
|MULE-5558 |Modules: XML, XSLT, XPath, SXC |The schema-validation-filter should allow configure errorHandler and resourceResolver via config
|MULE-5494 |Transport: JDBC |JDBC Query is reported as invalid when attempting to save stored procedure results in a variable
|MULE-5488 |Core: Endpoints |Messages may be sent to the wrong place when a dynamic endpoint is in use
|MULE-5443 |Core: (other) |Improve startup time for applications
|MULE-5395 |Modules: CXF |The Mule WebService frontend doesn't return a Business exception which exists in the contract of method
|MULE-5377 |Core: Routing / Filters |The First Successful message processor is only usable with request-response endpoints
|MULE-5319 |Core: Components |Problem using splitter in flow for 3.1
|MULE-5133 |Core: Deployment |IOException when redeploying a project
|MULE-5081 |Examples / Tutorials |A non-blocking exception exists in hello example
|MULE-4748 |Modules: Security (Spring Security, Acegi, PGP, WS-Security) |A signed plain-text message without signature does not fail the PGP security filter
|MULE-4599 |Core: API |dispose() method not called on transformer that implements Disposable
|MULE-5653 |Transport: JMS |Weblogic JMS transport, error in the reconnection to JMS
|EE-2469 |Transport: WebsphereMQ |ObjectToWMQJmsMessage does not fix invalid jms mesage property keys
|EE-2456 |Transport: WebsphereMQ |<wmq:message-to-object-transformer/> throws IllegalStateException when used in WMQ inbound-endpoints
|EE-2454 |Transport: WebsphereMQ |An empty response block in WMQ endpoints throws NPE at mule startup
|EE-2410 |Transport: JDBC |JDBC Cursor Leak
|EE-2399 |Transport: JMS, Transport: WebsphereMQ |The JMS and WMQ endpoints do not support transformers as child elements
|EE-2386 |Transport: WebsphereMQ |WMQ is not working with request-reply
|EE-2363 |Transport: JMS, Transport: WebsphereMQ |JMS endpoints don't allow <response> element
|EE-2360 |Transport: JDBC |JDBC endpoints convert column names to lowercase
|EE-2358 |Core: Configuration |Per-application logging doesn't create a log file for each application
|EE-2346 |Transport: CXF |The Mule CXF proxy is adding an extra tag element in the response
|EE-2345 |Core: (other) |The mainflow loses the properties added through the "Enricher" element of a subflow when it accesses another subflow
|EE-2338 |Core: (other) |Custom Evaluator Exceptions are not catched by Default Exception Strategy
|EE-2330 |Core: (other) |Mule 3 Session Props are not maintained when set on response transformer with chaining endpoints
|EE-2323 |Core: (other) |Mule is losing session properties when patch EE-2307 is applied
|EE-2319 |Transport: HTTP/ HTTPS |The ExceptionMessage object is not discarded after the Exception Strategy has been executed
|EE-2314 |Transport: WebsphereMQ |The WMQ connector's XSDs do not allow <transformer> as child elements
|EE-2312 |Core: Exception Handling |Exceptions are not logged in the console or app logs
|EE-2307 |Core: (other) |Session scope properties don't propagate between flows
|EE-2300 |Core: Registry |EE-2297 Thread contention occurs when MuleRegistry is accessed
|EE-2297 |Core: Bootstrap / Java Service Wrapper, Core: Components, Core: Concurrency / Threading |An umbrella issue for QAware findings impacts BMW
|EE-2281 |Transport: TCP / UDP / SSL / Multicast |TCP outbound-endpoint performance is poor
|EE-2273 |Transport: CXF |CXF does not invoke an exception strategy
|EE-2267 |Transport: JMS |The behavior of the JMSReplyTo and jms endpoints needs to be fixed
|EE-2240 |Core: Concurrency / Threading |Livelock occurs in stats gathering code on IBM AIX JDK
|EE-2208 |Build: Distributions, Examples / Tutorials |An unlimited GigaSpaces license is bundled in Mule 3.1.1 EE
|EE-2200 |Core: Routing / Filters, Transport: JMS |A Flows and async processing issue
|EE-2194 |Modules: (other) |SFDC Cloud Connector is hardcoded to the production site
|EE-2070 |Transport: WebsphereMQ |Remove the MQXAConnectionFactory import from WebsphereMQConnector class
|EE-2529 |Transport: HTTP/ HTTPS |Http endpoints are created every time the url used to invoke them changes.
|===
